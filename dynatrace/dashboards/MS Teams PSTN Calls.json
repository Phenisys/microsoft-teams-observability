{
    "version": 18,
    "variables": [
        {
            "version": 1,
            "key": "PSTNCallType",
            "type": "query",
            "visible": true,
            "editable": true,
            "input": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN\")\n| dedup callType\n| fields callType",
            "multiple": true,
            "defaultValue": [
                "3420b2ac-f1cf-4b24-b62d-61ba1ba8ed05*"
            ]
        },
        {
            "version": 1,
            "key": "callerNumber",
            "type": "query",
            "visible": true,
            "editable": true,
            "input": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter in(callType, array($PSTNCallType))\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| dedup callerNumber\n| fields callerNumber\n| sort callerNumber asc",
            "multiple": true,
            "defaultValue": [
                "3420b2ac-f1cf-4b24-b62d-61ba1ba8ed05*"
            ]
        },
        {
            "version": 1,
            "key": "calleeNumber",
            "type": "query",
            "visible": true,
            "editable": true,
            "input": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter in(callType, array($PSTNCallType))\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| dedup calleeNumber\n| fields calleeNumber\n| sort calleeNumber asc",
            "multiple": true,
            "defaultValue": [
                "3420b2ac-f1cf-4b24-b62d-61ba1ba8ed05*"
            ]
        }
    ],
    "tiles": {
        "0": {
            "title": "Daily Active Users per Country",
            "type": "data",
            "query": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| filter in(callType, array($PSTNCallType))\nAND in(callerNumber, array($callerNumber))\nAND in(calleeNumber, array($calleeNumber))\n| makeTimeseries `Daily Active Users` = countDistinct(userPrincipalName), by: { usageCountryCode }, interval:1d",
            "visualization": "barChart",
            "visualizationSettings": {
                "thresholds": [],
                "chartSettings": {
                    "xAxisScaling": "analyzedTimeframe",
                    "gapPolicy": "gap",
                    "circleChartSettings": {
                        "groupingThresholdType": "relative",
                        "groupingThresholdValue": 0,
                        "valueType": "relative"
                    },
                    "categoryOverrides": {},
                    "curve": "linear",
                    "pointsDisplay": "auto",
                    "categoricalBarChartSettings": {
                        "layout": "horizontal",
                        "categoryAxisTickLayout": "horizontal",
                        "scale": "absolute",
                        "groupMode": "stacked",
                        "colorPaletteMode": "multi-color",
                        "categoryAxisLabel": "usageCountryCode",
                        "valueAxisLabel": "interval",
                        "tooltipVariant": "single"
                    },
                    "colorPalette": "categorical",
                    "valueRepresentation": "absolute",
                    "truncationMode": "middle",
                    "xAxisLabel": "timeframe",
                    "xAxisIsLabelVisible": false,
                    "hiddenLegendFields": [
                        "interval"
                    ],
                    "fieldMapping": {
                        "timestamp": "timeframe",
                        "leftAxisValues": [
                            "Daily Active Users"
                        ]
                    },
                    "leftYAxisSettings": {}
                },
                "singleValue": {
                    "showLabel": true,
                    "label": "usageCountryCode",
                    "prefixIcon": "",
                    "recordField": "usageCountryCode",
                    "autoscale": true,
                    "sparklineSettings": {
                        "record": "count()"
                    },
                    "alignment": "center",
                    "trend": {
                        "trendType": "auto",
                        "isVisible": true
                    },
                    "colorThresholdTarget": "value"
                },
                "table": {
                    "rowDensity": "condensed",
                    "enableSparklines": false,
                    "hiddenColumns": [],
                    "linewrapEnabled": false,
                    "lineWrapIds": [],
                    "monospacedFontEnabled": false,
                    "monospacedFontColumns": [],
                    "columnWidths": {},
                    "columnTypeOverrides": [
                        {
                            "fields": [
                                "Daily Active Users"
                            ],
                            "value": "sparkline",
                            "id": 1742397419064
                        }
                    ]
                },
                "honeycomb": {
                    "shape": "hexagon",
                    "legend": {
                        "hidden": false,
                        "position": "auto",
                        "ratio": "auto"
                    },
                    "dataMappings": {
                        "value": "usageCountryCode"
                    },
                    "displayedFields": [
                        "usageCountryCode"
                    ],
                    "truncationMode": "middle",
                    "colorMode": "color-palette",
                    "colorPalette": "categorical"
                },
                "histogram": {
                    "legend": "auto",
                    "yAxis": {
                        "label": "Frequency",
                        "scale": "linear"
                    },
                    "colorPalette": "categorical",
                    "dataMappings": [
                        {
                            "valueAxis": "interval",
                            "rangeAxis": ""
                        }
                    ],
                    "variant": "single",
                    "truncationMode": "middle",
                    "displayedFields": [
                        "usageCountryCode"
                    ]
                },
                "valueBoundaries": {
                    "min": "auto",
                    "max": "auto"
                },
                "autoSelectVisualization": false,
                "dataMapping": {
                    "value": "interval"
                },
                "label": {
                    "showLabel": true,
                    "label": "interval"
                }
            },
            "querySettings": {
                "maxResultRecords": 1000,
                "defaultScanLimitGbytes": 500,
                "maxResultMegaBytes": 1,
                "defaultSamplingRatio": 10,
                "enableSampling": false
            },
            "davis": {
                "enabled": false,
                "davisVisualization": {
                    "isAvailable": true
                }
            },
            "timeframe": {
                "tileTimeframeEnabled": true,
                "tileTimeframe": {
                    "from": "now()-7d",
                    "to": "now()"
                }
            },
            "segments": {
                "tileSegments": [],
                "tileSegmentsEnabled": false
            }
        },
        "1": {
            "title": "Details (Last 50 calls)",
            "type": "data",
            "query": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| filter in(callType, array($PSTNCallType))\nAND in(callerNumber, array($callerNumber))\nAND in(calleeNumber, array($calleeNumber))\n| fields timestamp, duration, userDisplayName, callType, callerNumber, calleeNumber, operator\n| sort timestamp desc\n| limit 50",
            "visualization": "table",
            "visualizationSettings": {
                "thresholds": [],
                "chartSettings": {
                    "xAxisScaling": "analyzedTimeframe",
                    "gapPolicy": "gap",
                    "circleChartSettings": {
                        "groupingThresholdType": "relative",
                        "groupingThresholdValue": 0,
                        "valueType": "relative"
                    },
                    "categoryOverrides": {},
                    "curve": "linear",
                    "pointsDisplay": "auto",
                    "categoricalBarChartSettings": {
                        "layout": "horizontal",
                        "categoryAxisTickLayout": "horizontal",
                        "scale": "absolute",
                        "groupMode": "stacked",
                        "colorPaletteMode": "multi-color",
                        "categoryAxisLabel": "timestamp,userDisplayName,callType,callerNumber,calleeNumber,operator",
                        "valueAxisLabel": "duration",
                        "tooltipVariant": "single"
                    },
                    "colorPalette": "categorical",
                    "valueRepresentation": "absolute",
                    "truncationMode": "middle",
                    "xAxisLabel": "timestamp",
                    "xAxisIsLabelVisible": false,
                    "hiddenLegendFields": [
                        "interval",
                        "duration"
                    ],
                    "leftYAxisSettings": {},
                    "fieldMapping": {
                        "timestamp": "timestamp",
                        "leftAxisValues": [
                            "duration"
                        ]
                    }
                },
                "singleValue": {
                    "showLabel": true,
                    "label": "usageCountryCode",
                    "prefixIcon": "",
                    "recordField": "usageCountryCode",
                    "autoscale": true,
                    "sparklineSettings": {
                        "record": "count()"
                    },
                    "alignment": "center",
                    "trend": {
                        "trendType": "auto",
                        "isVisible": true
                    },
                    "colorThresholdTarget": "value"
                },
                "table": {
                    "rowDensity": "condensed",
                    "enableSparklines": false,
                    "hiddenColumns": [],
                    "linewrapEnabled": false,
                    "lineWrapIds": [],
                    "monospacedFontEnabled": false,
                    "monospacedFontColumns": [],
                    "columnWidths": {},
                    "columnTypeOverrides": []
                },
                "honeycomb": {
                    "shape": "hexagon",
                    "legend": {
                        "hidden": false,
                        "position": "auto",
                        "ratio": "auto"
                    },
                    "dataMappings": {
                        "value": "duration"
                    },
                    "displayedFields": [
                        "userDisplayName",
                        "callType",
                        "callerNumber",
                        "calleeNumber",
                        "operator"
                    ],
                    "truncationMode": "middle",
                    "colorMode": "color-palette",
                    "colorPalette": "blue"
                },
                "histogram": {
                    "legend": "auto",
                    "yAxis": {
                        "label": "Frequency",
                        "scale": "linear"
                    },
                    "colorPalette": "categorical",
                    "dataMappings": [
                        {
                            "valueAxis": "duration",
                            "rangeAxis": ""
                        }
                    ],
                    "variant": "single",
                    "truncationMode": "middle",
                    "displayedFields": [
                        "userDisplayName"
                    ]
                },
                "valueBoundaries": {
                    "min": "auto",
                    "max": "auto"
                },
                "autoSelectVisualization": false,
                "dataMapping": {
                    "value": "interval"
                },
                "label": {
                    "showLabel": true,
                    "label": "interval"
                }
            },
            "querySettings": {
                "maxResultRecords": 1000,
                "defaultScanLimitGbytes": 500,
                "maxResultMegaBytes": 1,
                "defaultSamplingRatio": 10,
                "enableSampling": false
            },
            "davis": {
                "enabled": false,
                "davisVisualization": {
                    "isAvailable": true
                }
            }
        },
        "2": {
            "title": "Total Calls",
            "type": "data",
            "query": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| filter in(callType, array($PSTNCallType))\nAND in(callerNumber, array($callerNumber))\nAND in(calleeNumber, array($calleeNumber))\n| fieldsAdd call.id = if(isNotNull(id), id, else: call.id) //Old data\n| summarize countDistinct(call.id)",
            "visualization": "singleValue",
            "visualizationSettings": {
                "thresholds": [],
                "chartSettings": {
                    "xAxisScaling": "analyzedTimeframe",
                    "gapPolicy": "gap",
                    "circleChartSettings": {
                        "groupingThresholdType": "relative",
                        "groupingThresholdValue": 0,
                        "valueType": "relative"
                    },
                    "categoryOverrides": {},
                    "curve": "linear",
                    "pointsDisplay": "auto",
                    "categoricalBarChartSettings": {
                        "layout": "horizontal",
                        "categoryAxisTickLayout": "horizontal",
                        "scale": "absolute",
                        "groupMode": "stacked",
                        "colorPaletteMode": "multi-color",
                        "categoryAxisLabel": "countDistinct(call.id)",
                        "valueAxisLabel": "countDistinct(call.id)",
                        "tooltipVariant": "single"
                    },
                    "colorPalette": "categorical",
                    "valueRepresentation": "absolute",
                    "truncationMode": "middle",
                    "xAxisLabel": "timeframe",
                    "xAxisIsLabelVisible": false,
                    "hiddenLegendFields": [
                        "interval"
                    ],
                    "leftYAxisSettings": {}
                },
                "singleValue": {
                    "showLabel": false,
                    "label": "usageCountryCode",
                    "prefixIcon": "CallIcon",
                    "recordField": "countDistinct(call.id)",
                    "autoscale": true,
                    "sparklineSettings": {
                        "record": "count()"
                    },
                    "alignment": "center",
                    "trend": {
                        "trendType": "auto",
                        "isVisible": true
                    },
                    "colorThresholdTarget": "background",
                    "isIconVisible": true
                },
                "table": {
                    "rowDensity": "condensed",
                    "enableSparklines": false,
                    "hiddenColumns": [],
                    "linewrapEnabled": false,
                    "lineWrapIds": [],
                    "monospacedFontEnabled": false,
                    "monospacedFontColumns": [],
                    "columnWidths": {},
                    "columnTypeOverrides": []
                },
                "honeycomb": {
                    "shape": "hexagon",
                    "legend": {
                        "hidden": false,
                        "position": "auto",
                        "ratio": "auto"
                    },
                    "dataMappings": {},
                    "displayedFields": [],
                    "truncationMode": "middle",
                    "colorMode": "color-palette",
                    "colorPalette": "categorical"
                },
                "histogram": {
                    "legend": "auto",
                    "yAxis": {
                        "label": "Frequency",
                        "scale": "linear"
                    },
                    "colorPalette": "categorical",
                    "dataMappings": [
                        {
                            "valueAxis": "countDistinct(call.id)",
                            "rangeAxis": ""
                        }
                    ],
                    "variant": "single",
                    "truncationMode": "middle",
                    "displayedFields": []
                },
                "valueBoundaries": {
                    "min": "auto",
                    "max": "auto"
                },
                "autoSelectVisualization": false,
                "dataMapping": {
                    "value": "interval"
                },
                "label": {
                    "showLabel": true,
                    "label": "interval"
                }
            },
            "querySettings": {
                "maxResultRecords": 1000,
                "defaultScanLimitGbytes": 500,
                "maxResultMegaBytes": 1,
                "defaultSamplingRatio": 10,
                "enableSampling": false
            },
            "davis": {
                "enabled": false,
                "davisVisualization": {
                    "isAvailable": true
                }
            }
        },
        "3": {
            "title": "Total Minutes",
            "type": "data",
            "query": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| filter in(callType, array($PSTNCallType))\nAND in(callerNumber, array($callerNumber))\nAND in(calleeNumber, array($calleeNumber))\n| summarize sum(duration)",
            "visualization": "singleValue",
            "visualizationSettings": {
                "thresholds": [],
                "chartSettings": {
                    "xAxisScaling": "analyzedTimeframe",
                    "gapPolicy": "gap",
                    "circleChartSettings": {
                        "groupingThresholdType": "relative",
                        "groupingThresholdValue": 0,
                        "valueType": "relative"
                    },
                    "categoryOverrides": {},
                    "curve": "linear",
                    "pointsDisplay": "auto",
                    "categoricalBarChartSettings": {
                        "layout": "horizontal",
                        "categoryAxisTickLayout": "horizontal",
                        "scale": "absolute",
                        "groupMode": "stacked",
                        "colorPaletteMode": "multi-color",
                        "categoryAxisLabel": "sum(duration)",
                        "valueAxisLabel": "sum(duration)",
                        "tooltipVariant": "single"
                    },
                    "colorPalette": "categorical",
                    "valueRepresentation": "absolute",
                    "truncationMode": "middle",
                    "xAxisLabel": "timeframe",
                    "xAxisIsLabelVisible": false,
                    "hiddenLegendFields": [
                        "interval"
                    ],
                    "leftYAxisSettings": {}
                },
                "singleValue": {
                    "showLabel": false,
                    "label": "usageCountryCode",
                    "prefixIcon": "StopwatchIcon",
                    "recordField": "sum(duration)",
                    "autoscale": true,
                    "sparklineSettings": {
                        "record": "count()"
                    },
                    "alignment": "center",
                    "trend": {
                        "trendType": "auto",
                        "isVisible": true
                    },
                    "colorThresholdTarget": "background",
                    "isIconVisible": true
                },
                "table": {
                    "rowDensity": "condensed",
                    "enableSparklines": false,
                    "hiddenColumns": [],
                    "linewrapEnabled": false,
                    "lineWrapIds": [],
                    "monospacedFontEnabled": false,
                    "monospacedFontColumns": [],
                    "columnWidths": {},
                    "columnTypeOverrides": []
                },
                "honeycomb": {
                    "shape": "hexagon",
                    "legend": {
                        "hidden": false,
                        "position": "auto",
                        "ratio": "auto"
                    },
                    "dataMappings": {},
                    "displayedFields": [],
                    "truncationMode": "middle",
                    "colorMode": "color-palette",
                    "colorPalette": "categorical"
                },
                "histogram": {
                    "legend": "auto",
                    "yAxis": {
                        "label": "Frequency",
                        "scale": "linear"
                    },
                    "colorPalette": "categorical",
                    "dataMappings": [
                        {
                            "valueAxis": "sum(duration)",
                            "rangeAxis": ""
                        }
                    ],
                    "variant": "single",
                    "truncationMode": "middle",
                    "displayedFields": []
                },
                "valueBoundaries": {
                    "min": "auto",
                    "max": "auto"
                },
                "autoSelectVisualization": false,
                "dataMapping": {
                    "value": "interval"
                },
                "label": {
                    "showLabel": true,
                    "label": "interval"
                },
                "unitsOverrides": [
                    {
                        "identifier": "sum(duration)",
                        "unitCategory": "time",
                        "baseUnit": "second",
                        "displayUnit": null,
                        "decimals": 2,
                        "suffix": "",
                        "delimiter": false,
                        "added": 1742395483518
                    }
                ]
            },
            "querySettings": {
                "maxResultRecords": 1000,
                "defaultScanLimitGbytes": 500,
                "maxResultMegaBytes": 1,
                "defaultSamplingRatio": 10,
                "enableSampling": false
            },
            "davis": {
                "enabled": false,
                "davisVisualization": {
                    "isAvailable": true
                }
            }
        },
        "4": {
            "type": "markdown",
            "content": "**Teams user call types**\n* user_in - the user received an inbound PSTN call\n* user_out - the user placed an outbound PSTN call\n* user_out_conf - the user added two or more PSTN participants to the call such as a three-way conference call\n* user_out_transfer - the user transferred the call to a PSTN number\n* user_out_forwarding - the user forwarded the call to a PSTN number\n* conf_in - an inbound call to the Audio Conferencing bridge\n* conf_out - an outbound call from the Audio Conferencing bridge usually to add a PSTN number to the conference\n* unassigned_in - an inbound PSTN call via Calling Plan to an unassigned number\n* emergency_in - the user received an inbound PSTN emergency call\n* emergency_out - the user placed an outbound PSTN emergency call\n* fmc_in - the user received an inbound PSTN call from native dialer\n* fmc_out - the user placed an outbound PSTN call to native dialer\n\n**Teams bots call types**\n* ucap_in - an inbound PSTN call to Teams bot such as auto attendant or call queue\n* ucap_out - an outbound PSTN call from a Teams bot such as auto attendant or call queue\n* ucap_out_conf - a Teams bot such as auto attendant or call queue added two of more PSTN participants to the call such as a three way call conference"
        },
        "5": {
            "title": "Count by CallType",
            "type": "data",
            "query": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| filter in(callType, array($PSTNCallType))\nAND in(callerNumber, array($callerNumber))\nAND in(calleeNumber, array($calleeNumber))\n| fieldsAdd callType = if((callType == \"oc_user_in\"),\"Inbound calls\",\nelse:if((callType == \"oc_ucap_in\"),\"Inbound Teams Bot calls\", \nelse:if(callType == \"oc_user_out\",\"Outbound calls\",\nelse:if(callType == \"conf_in\",\"Inbound to Audio Bridge\",\nelse:if(callType == \"oc_user_out_forwarding\",\"Forward to PSTN Number\"\n)))))\n| filterOut isNull(callType)\n| makeTimeseries count(), by:{ callType }, interval:1d\n",
            "visualization": "barChart",
            "visualizationSettings": {
                "thresholds": [],
                "chartSettings": {
                    "xAxisScaling": "analyzedTimeframe",
                    "gapPolicy": "gap",
                    "circleChartSettings": {
                        "groupingThresholdType": "relative",
                        "groupingThresholdValue": 0,
                        "valueType": "relative"
                    },
                    "categoryOverrides": {},
                    "curve": "linear",
                    "pointsDisplay": "auto",
                    "categoricalBarChartSettings": {
                        "layout": "horizontal",
                        "categoryAxisTickLayout": "horizontal",
                        "scale": "absolute",
                        "groupMode": "stacked",
                        "colorPaletteMode": "multi-color",
                        "categoryAxisLabel": "callType",
                        "valueAxisLabel": "interval",
                        "tooltipVariant": "single"
                    },
                    "colorPalette": "categorical",
                    "valueRepresentation": "absolute",
                    "truncationMode": "end",
                    "xAxisLabel": "timeframe",
                    "xAxisIsLabelVisible": false,
                    "hiddenLegendFields": [
                        "interval"
                    ],
                    "fieldMapping": {
                        "timestamp": "timeframe",
                        "leftAxisValues": [
                            "count()"
                        ]
                    },
                    "leftYAxisSettings": {}
                },
                "singleValue": {
                    "showLabel": true,
                    "label": "callType",
                    "prefixIcon": "",
                    "recordField": "callType",
                    "autoscale": true,
                    "sparklineSettings": {
                        "record": "count()"
                    },
                    "alignment": "center",
                    "trend": {
                        "trendType": "auto",
                        "isVisible": true
                    },
                    "colorThresholdTarget": "value"
                },
                "table": {
                    "rowDensity": "condensed",
                    "enableSparklines": false,
                    "hiddenColumns": [],
                    "linewrapEnabled": false,
                    "lineWrapIds": [],
                    "monospacedFontEnabled": false,
                    "monospacedFontColumns": [],
                    "columnWidths": {},
                    "columnTypeOverrides": [
                        {
                            "fields": [
                                "count()"
                            ],
                            "value": "sparkline",
                            "id": 1742398983280
                        }
                    ]
                },
                "honeycomb": {
                    "shape": "hexagon",
                    "legend": {
                        "hidden": false,
                        "position": "auto",
                        "ratio": "auto"
                    },
                    "dataMappings": {
                        "value": "callType"
                    },
                    "displayedFields": [
                        "callType"
                    ],
                    "truncationMode": "middle",
                    "colorMode": "color-palette",
                    "colorPalette": "categorical"
                },
                "histogram": {
                    "legend": "auto",
                    "yAxis": {
                        "label": "Frequency",
                        "scale": "linear"
                    },
                    "colorPalette": "categorical",
                    "dataMappings": [
                        {
                            "valueAxis": "interval",
                            "rangeAxis": ""
                        }
                    ],
                    "variant": "single",
                    "truncationMode": "middle",
                    "displayedFields": [
                        "callType"
                    ]
                },
                "valueBoundaries": {
                    "min": "auto",
                    "max": "auto"
                },
                "autoSelectVisualization": false,
                "dataMapping": {
                    "value": "interval"
                },
                "label": {
                    "showLabel": true,
                    "label": "interval"
                },
                "legend": {
                    "showLegend": false,
                    "position": "auto",
                    "ratio": 33
                }
            },
            "querySettings": {
                "maxResultRecords": 1000,
                "defaultScanLimitGbytes": 500,
                "maxResultMegaBytes": 1,
                "defaultSamplingRatio": 10,
                "enableSampling": false
            },
            "davis": {
                "enabled": false,
                "davisVisualization": {
                    "isAvailable": true
                }
            },
            "timeframe": {
                "tileTimeframeEnabled": true,
                "tileTimeframe": {
                    "from": "now()-7d",
                    "to": "now()"
                }
            },
            "segments": {
                "tileSegments": [],
                "tileSegmentsEnabled": false
            }
        },
        "6": {
            "title": "Count by Operator and License",
            "type": "data",
            "query": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| filter in(callType, array($PSTNCallType))\nAND in(callerNumber, array($callerNumber))\nAND in(calleeNumber, array($calleeNumber))\n| makeTimeseries count(), by: { operator, licenseCapability }, interval:1d",
            "visualization": "barChart",
            "visualizationSettings": {
                "thresholds": [],
                "chartSettings": {
                    "xAxisScaling": "analyzedTimeframe",
                    "gapPolicy": "gap",
                    "circleChartSettings": {
                        "groupingThresholdType": "relative",
                        "groupingThresholdValue": 0,
                        "valueType": "relative"
                    },
                    "categoryOverrides": {},
                    "curve": "linear",
                    "pointsDisplay": "auto",
                    "categoricalBarChartSettings": {
                        "layout": "horizontal",
                        "categoryAxisTickLayout": "horizontal",
                        "scale": "absolute",
                        "groupMode": "stacked",
                        "colorPaletteMode": "multi-color",
                        "categoryAxisLabel": "operator,licenseCapability",
                        "valueAxisLabel": "interval",
                        "tooltipVariant": "single"
                    },
                    "colorPalette": "categorical",
                    "valueRepresentation": "absolute",
                    "truncationMode": "middle",
                    "fieldMapping": {
                        "timestamp": "timeframe",
                        "leftAxisValues": [
                            "count()"
                        ]
                    },
                    "xAxisLabel": "timeframe",
                    "xAxisIsLabelVisible": false,
                    "hiddenLegendFields": [
                        "interval"
                    ],
                    "leftYAxisSettings": {}
                },
                "singleValue": {
                    "showLabel": true,
                    "label": "error",
                    "prefixIcon": "",
                    "recordField": "error",
                    "autoscale": true,
                    "sparklineSettings": {
                        "record": "count()"
                    },
                    "alignment": "center",
                    "trend": {
                        "trendType": "auto",
                        "isVisible": true
                    },
                    "colorThresholdTarget": "value"
                },
                "table": {
                    "rowDensity": "condensed",
                    "enableSparklines": false,
                    "hiddenColumns": [],
                    "linewrapEnabled": false,
                    "lineWrapIds": [],
                    "monospacedFontEnabled": false,
                    "monospacedFontColumns": [],
                    "columnWidths": {},
                    "columnTypeOverrides": [
                        {
                            "fields": [
                                "count()"
                            ],
                            "value": "sparkline",
                            "id": 1742397813110
                        }
                    ]
                },
                "honeycomb": {
                    "shape": "hexagon",
                    "legend": {
                        "hidden": false,
                        "position": "auto",
                        "ratio": "auto"
                    },
                    "dataMappings": {
                        "value": "operator"
                    },
                    "displayedFields": [
                        "operator",
                        "licenseCapability"
                    ],
                    "truncationMode": "middle",
                    "colorMode": "color-palette",
                    "colorPalette": "categorical"
                },
                "histogram": {
                    "legend": "auto",
                    "yAxis": {
                        "label": "Frequency",
                        "scale": "linear"
                    },
                    "colorPalette": "categorical",
                    "dataMappings": [
                        {
                            "valueAxis": "interval",
                            "rangeAxis": ""
                        }
                    ],
                    "variant": "single",
                    "truncationMode": "middle",
                    "displayedFields": [
                        "operator"
                    ]
                },
                "valueBoundaries": {
                    "min": "auto",
                    "max": "auto"
                },
                "autoSelectVisualization": false,
                "dataMapping": {
                    "value": "interval"
                },
                "label": {
                    "showLabel": false,
                    "label": "interval"
                }
            },
            "querySettings": {
                "maxResultRecords": 1000,
                "defaultScanLimitGbytes": 500,
                "maxResultMegaBytes": 1,
                "defaultSamplingRatio": 10,
                "enableSampling": false
            },
            "davis": {
                "enabled": false,
                "davisVisualization": {
                    "isAvailable": true
                }
            },
            "timeframe": {
                "tileTimeframeEnabled": true,
                "tileTimeframe": {
                    "from": "now()-7d",
                    "to": "now()"
                }
            }
        },
        "7": {
            "title": "Cost by Operator and License",
            "type": "data",
            "query": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| filter in(callType, array($PSTNCallType))\nAND in(callerNumber, array($callerNumber))\nAND in(calleeNumber, array($calleeNumber))\n| makeTimeseries `Call fee`= sum(charge), \n`Connection fee` = sum(connectionCharge), \nby: { operator, licenseCapability }, interval:1d",
            "visualization": "barChart",
            "visualizationSettings": {
                "thresholds": [],
                "chartSettings": {
                    "xAxisScaling": "analyzedTimeframe",
                    "gapPolicy": "gap",
                    "circleChartSettings": {
                        "groupingThresholdType": "relative",
                        "groupingThresholdValue": 0,
                        "valueType": "relative"
                    },
                    "categoryOverrides": {},
                    "curve": "linear",
                    "pointsDisplay": "auto",
                    "categoricalBarChartSettings": {
                        "layout": "horizontal",
                        "categoryAxisTickLayout": "horizontal",
                        "scale": "absolute",
                        "groupMode": "stacked",
                        "colorPaletteMode": "multi-color",
                        "categoryAxisLabel": "operator,licenseCapability",
                        "valueAxisLabel": "interval",
                        "tooltipVariant": "single"
                    },
                    "colorPalette": "categorical",
                    "valueRepresentation": "absolute",
                    "truncationMode": "middle",
                    "bandChartSettings": {
                        "lower": "Call fee",
                        "upper": "Connection fee"
                    },
                    "fieldMapping": {
                        "timestamp": "timeframe",
                        "leftAxisValues": [
                            "Call fee",
                            "Connection fee"
                        ]
                    },
                    "xAxisLabel": "timeframe",
                    "xAxisIsLabelVisible": false,
                    "hiddenLegendFields": [
                        "interval"
                    ],
                    "leftYAxisSettings": {}
                },
                "singleValue": {
                    "showLabel": true,
                    "label": "error",
                    "prefixIcon": "",
                    "recordField": "error",
                    "autoscale": true,
                    "sparklineSettings": {
                        "record": "count()"
                    },
                    "alignment": "center",
                    "trend": {
                        "trendType": "auto",
                        "isVisible": true
                    },
                    "colorThresholdTarget": "value"
                },
                "table": {
                    "rowDensity": "condensed",
                    "enableSparklines": false,
                    "hiddenColumns": [],
                    "linewrapEnabled": false,
                    "lineWrapIds": [],
                    "monospacedFontEnabled": false,
                    "monospacedFontColumns": [],
                    "columnWidths": {},
                    "columnTypeOverrides": [
                        {
                            "fields": [
                                "Call fee",
                                "Connection fee"
                            ],
                            "value": "sparkline",
                            "id": 1742398113991
                        }
                    ]
                },
                "honeycomb": {
                    "shape": "hexagon",
                    "legend": {
                        "hidden": false,
                        "position": "auto",
                        "ratio": "auto"
                    },
                    "dataMappings": {
                        "value": "operator"
                    },
                    "displayedFields": [
                        "operator",
                        "licenseCapability"
                    ],
                    "truncationMode": "middle",
                    "colorMode": "color-palette",
                    "colorPalette": "categorical"
                },
                "histogram": {
                    "legend": "auto",
                    "yAxis": {
                        "label": "Frequency",
                        "scale": "linear"
                    },
                    "colorPalette": "categorical",
                    "dataMappings": [
                        {
                            "valueAxis": "interval",
                            "rangeAxis": ""
                        }
                    ],
                    "variant": "single",
                    "truncationMode": "middle",
                    "displayedFields": [
                        "operator"
                    ]
                },
                "valueBoundaries": {
                    "min": "auto",
                    "max": "auto"
                },
                "autoSelectVisualization": false,
                "dataMapping": {
                    "value": "interval"
                },
                "label": {
                    "showLabel": false,
                    "label": "interval"
                },
                "legend": {
                    "showLegend": false,
                    "position": "auto",
                    "ratio": 45
                }
            },
            "querySettings": {
                "maxResultRecords": 1000,
                "defaultScanLimitGbytes": 500,
                "maxResultMegaBytes": 1,
                "defaultSamplingRatio": 10,
                "enableSampling": false
            },
            "davis": {
                "enabled": false,
                "davisVisualization": {
                    "isAvailable": true
                }
            },
            "timeframe": {
                "tileTimeframeEnabled": true,
                "tileTimeframe": {
                    "from": "now()-7d",
                    "to": "now()"
                }
            }
        },
        "8": {
            "type": "markdown",
            "content": "[API Documentation](https://learn.microsoft.com/en-us/graph/api/resources/callrecords-pstncalllogrow?view=graph-rest-1.0)"
        },
        "9": {
            "title": "Call fees",
            "type": "data",
            "query": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| filter in(callType, array($PSTNCallType))\nAND in(callerNumber, array($callerNumber))\nAND in(calleeNumber, array($calleeNumber))\n| summarize sum(connectionCharge)",
            "visualization": "singleValue",
            "visualizationSettings": {
                "thresholds": [],
                "chartSettings": {
                    "xAxisScaling": "analyzedTimeframe",
                    "gapPolicy": "gap",
                    "circleChartSettings": {
                        "groupingThresholdType": "relative",
                        "groupingThresholdValue": 0,
                        "valueType": "relative"
                    },
                    "categoryOverrides": {},
                    "curve": "linear",
                    "pointsDisplay": "auto",
                    "categoricalBarChartSettings": {
                        "layout": "horizontal",
                        "categoryAxisTickLayout": "horizontal",
                        "scale": "absolute",
                        "groupMode": "stacked",
                        "colorPaletteMode": "multi-color",
                        "categoryAxisLabel": "sum(connectionCharge)",
                        "valueAxisLabel": "sum(connectionCharge)",
                        "tooltipVariant": "single"
                    },
                    "colorPalette": "categorical",
                    "valueRepresentation": "absolute",
                    "truncationMode": "middle",
                    "xAxisLabel": "timeframe",
                    "xAxisIsLabelVisible": false,
                    "hiddenLegendFields": [
                        "interval"
                    ],
                    "leftYAxisSettings": {}
                },
                "singleValue": {
                    "showLabel": false,
                    "label": "usageCountryCode",
                    "prefixIcon": "MoneyIcon",
                    "recordField": "sum(connectionCharge)",
                    "autoscale": true,
                    "sparklineSettings": {
                        "record": "count()"
                    },
                    "alignment": "center",
                    "trend": {
                        "trendType": "auto",
                        "isVisible": true
                    },
                    "colorThresholdTarget": "background",
                    "isIconVisible": true
                },
                "table": {
                    "rowDensity": "condensed",
                    "enableSparklines": false,
                    "hiddenColumns": [],
                    "linewrapEnabled": false,
                    "lineWrapIds": [],
                    "monospacedFontEnabled": false,
                    "monospacedFontColumns": [],
                    "columnWidths": {},
                    "columnTypeOverrides": []
                },
                "honeycomb": {
                    "shape": "hexagon",
                    "legend": {
                        "hidden": false,
                        "position": "auto",
                        "ratio": "auto"
                    },
                    "dataMappings": {},
                    "displayedFields": [],
                    "truncationMode": "middle",
                    "colorMode": "color-palette",
                    "colorPalette": "categorical"
                },
                "histogram": {
                    "legend": "auto",
                    "yAxis": {
                        "label": "Frequency",
                        "scale": "linear"
                    },
                    "colorPalette": "categorical",
                    "dataMappings": [
                        {
                            "valueAxis": "sum(connectionCharge)",
                            "rangeAxis": ""
                        }
                    ],
                    "variant": "single",
                    "truncationMode": "middle",
                    "displayedFields": []
                },
                "valueBoundaries": {
                    "min": "auto",
                    "max": "auto"
                },
                "autoSelectVisualization": false,
                "dataMapping": {
                    "value": "interval"
                },
                "label": {
                    "showLabel": true,
                    "label": "interval"
                },
                "unitsOverrides": [
                    {
                        "identifier": "sum(connectionCharge)",
                        "unitCategory": "currency",
                        "baseUnit": "eur",
                        "displayUnit": null,
                        "decimals": 2,
                        "suffix": "",
                        "delimiter": false,
                        "added": 1742398490044
                    }
                ]
            },
            "querySettings": {
                "maxResultRecords": 1000,
                "defaultScanLimitGbytes": 500,
                "maxResultMegaBytes": 1,
                "defaultSamplingRatio": 10,
                "enableSampling": false
            },
            "davis": {
                "enabled": false,
                "davisVisualization": {
                    "isAvailable": true
                }
            }
        },
        "10": {
            "title": "Connection Fees",
            "type": "data",
            "query": "fetch logs\n| filter dt.system.bucket==\"ms_teams\"\n| filter matchesValue(log.source,\"MSTeams_CallRecords_PSTN*\")\n| filter in(callType, array($PSTNCallType))\nAND in(callerNumber, array($callerNumber))\nAND in(calleeNumber, array($calleeNumber))\n| summarize sum(charge)",
            "visualization": "singleValue",
            "visualizationSettings": {
                "thresholds": [],
                "chartSettings": {
                    "xAxisScaling": "analyzedTimeframe",
                    "gapPolicy": "gap",
                    "circleChartSettings": {
                        "groupingThresholdType": "relative",
                        "groupingThresholdValue": 0,
                        "valueType": "relative"
                    },
                    "categoryOverrides": {},
                    "curve": "linear",
                    "pointsDisplay": "auto",
                    "categoricalBarChartSettings": {
                        "layout": "horizontal",
                        "categoryAxisTickLayout": "horizontal",
                        "scale": "absolute",
                        "groupMode": "stacked",
                        "colorPaletteMode": "multi-color",
                        "categoryAxisLabel": "sum(charge)",
                        "valueAxisLabel": "sum(charge)",
                        "tooltipVariant": "single"
                    },
                    "colorPalette": "categorical",
                    "valueRepresentation": "absolute",
                    "truncationMode": "middle",
                    "xAxisLabel": "timeframe",
                    "xAxisIsLabelVisible": false,
                    "hiddenLegendFields": [
                        "interval"
                    ],
                    "leftYAxisSettings": {}
                },
                "singleValue": {
                    "showLabel": false,
                    "label": "usageCountryCode",
                    "prefixIcon": "MoneyIcon",
                    "recordField": "sum(charge)",
                    "autoscale": true,
                    "sparklineSettings": {
                        "record": "count()"
                    },
                    "alignment": "center",
                    "trend": {
                        "trendType": "auto",
                        "isVisible": true
                    },
                    "colorThresholdTarget": "background",
                    "isIconVisible": true
                },
                "table": {
                    "rowDensity": "condensed",
                    "enableSparklines": false,
                    "hiddenColumns": [],
                    "linewrapEnabled": false,
                    "lineWrapIds": [],
                    "monospacedFontEnabled": false,
                    "monospacedFontColumns": [],
                    "columnWidths": {},
                    "columnTypeOverrides": []
                },
                "honeycomb": {
                    "shape": "hexagon",
                    "legend": {
                        "hidden": false,
                        "position": "auto",
                        "ratio": "auto"
                    },
                    "dataMappings": {},
                    "displayedFields": [],
                    "truncationMode": "middle",
                    "colorMode": "color-palette",
                    "colorPalette": "categorical"
                },
                "histogram": {
                    "legend": "auto",
                    "yAxis": {
                        "label": "Frequency",
                        "scale": "linear"
                    },
                    "colorPalette": "categorical",
                    "dataMappings": [
                        {
                            "valueAxis": "sum(charge)",
                            "rangeAxis": ""
                        }
                    ],
                    "variant": "single",
                    "truncationMode": "middle",
                    "displayedFields": []
                },
                "valueBoundaries": {
                    "min": "auto",
                    "max": "auto"
                },
                "autoSelectVisualization": false,
                "dataMapping": {
                    "value": "interval"
                },
                "label": {
                    "showLabel": true,
                    "label": "interval"
                },
                "unitsOverrides": [
                    {
                        "identifier": "sum(charge)",
                        "unitCategory": "currency",
                        "baseUnit": "eur",
                        "displayUnit": null,
                        "decimals": 2,
                        "suffix": "",
                        "delimiter": false,
                        "added": 1742398490044
                    }
                ]
            },
            "querySettings": {
                "maxResultRecords": 1000,
                "defaultScanLimitGbytes": 500,
                "maxResultMegaBytes": 1,
                "defaultSamplingRatio": 10,
                "enableSampling": false
            },
            "davis": {
                "enabled": false,
                "davisVisualization": {
                    "isAvailable": true
                }
            }
        }
    },
    "layouts": {
        "0": {
            "x": 0,
            "y": 3,
            "w": 11,
            "h": 5
        },
        "1": {
            "x": 0,
            "y": 14,
            "w": 13,
            "h": 9
        },
        "2": {
            "x": 0,
            "y": 0,
            "w": 3,
            "h": 3
        },
        "3": {
            "x": 3,
            "y": 0,
            "w": 3,
            "h": 3
        },
        "4": {
            "x": 13,
            "y": 14,
            "w": 11,
            "h": 9
        },
        "5": {
            "x": 11,
            "y": 3,
            "w": 12,
            "h": 5
        },
        "6": {
            "x": 0,
            "y": 8,
            "w": 11,
            "h": 6
        },
        "7": {
            "x": 11,
            "y": 8,
            "w": 12,
            "h": 6
        },
        "8": {
            "x": 18,
            "y": 0,
            "w": 6,
            "h": 3
        },
        "9": {
            "x": 9,
            "y": 0,
            "w": 3,
            "h": 3
        },
        "10": {
            "x": 6,
            "y": 0,
            "w": 3,
            "h": 3
        }
    },
    "importedWithCode": false,
    "settings": {}
}